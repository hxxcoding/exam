(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6de3fad1"],{"14a5":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return r}));var n=function(t,e){var a="1.23452384164.123412415";null!==document.getElementById(a)&&document.body.removeChild(document.getElementById(a));var n=document.createElement("canvas");n.width=200,n.height=120;var i=n.getContext("2d");i.rotate(-20*Math.PI/180),i.font="16px Vedana",i.fillStyle="#666666",i.textAlign="center",i.textBaseline="Middle",i.fillText(t,n.width/2,n.height),i.fillText(e,n.width/2,n.height+22);var r=document.createElement("div");return r.id=a,r.style.pointerEvents="none",r.style.top="0px",r.style.left="0px",r.style.opacity="0.15",r.style.position="fixed",r.style.zIndex="100000",r.style.width=document.documentElement.clientWidth+"px",r.style.height=document.documentElement.clientHeight+"px",r.style.background="url("+n.toDataURL("image/png")+") left top repeat",document.body.appendChild(r),a},i=function(t,e){var a=n(t,e);null===document.getElementById(a)&&(a=n(t,e))},r=function(){var t="1.23452384164.123412415";null!==document.getElementById(t)&&document.body.removeChild(document.getElementById(t))}},"2f21":function(t,e,a){"use strict";var n=a("79e5");t.exports=function(t,e){return!!t&&n((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},3200:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return r})),a.d(e,"b",(function(){return s})),a.d(e,"g",(function(){return c})),a.d(e,"c",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"f",(function(){return u}));var n=a("b775");function i(t){return Object(n["b"])("/exam/api/paper/paper/create-paper",t)}function r(t){return Object(n["b"])("/exam/api/paper/paper/paper-detail",t)}function s(t,e){return Object(n["b"])("/exam/api/paper/paper/paper-result/office/points",{paperId:t,quId:e})}function c(t){return Object(n["b"])("/exam/api/paper/paper/qu-detail",t)}function o(t){return Object(n["b"])("/exam/api/paper/paper/fill-answer",t)}function l(t){return Object(n["b"])("/exam/api/paper/paper/hand-exam",t)}function u(t){return Object(n["b"])("/exam/api/paper/paper/paper-result",t)}},"55dd":function(t,e,a){"use strict";var n=a("5ca1"),i=a("d8e8"),r=a("4bf8"),s=a("79e5"),c=[].sort,o=[1,2,3];n(n.P+n.F*(s((function(){o.sort(void 0)}))||!s((function(){o.sort(null)}))||!a("2f21")(c)),"Array",{sort:function(t){return void 0===t?c.call(r(this)):c.call(r(this),i(t))}})},"70fe":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("el-card",{staticStyle:{"margin-bottom":"10px"}},[t._v(" 距离考试结束还有："),a("exam-timer",{on:{timeout:function(e){return t.doHandler()}},model:{value:t.paperData.leftSeconds,callback:function(e){t.$set(t.paperData,"leftSeconds",e)},expression:"paperData.leftSeconds"}}),a("el-button",{staticStyle:{float:"right","margin-top":"-10px"},attrs:{type:"warning",icon:"el-icon-plus",loading:t.loading},on:{click:function(e){return t.handHandExam()}}},[t._v(" "+t._s(t.handleText)+" ")])],1)],1),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:6,xs:24}},[a("el-card",[a("p",{staticClass:"card-title"},[a("strong",[t._v("答题卡")])]),a("el-row",{staticClass:"card-line",staticStyle:{"padding-left":"10px"},attrs:{gutter:24}},[a("el-tag",{attrs:{type:"info"}},[t._v("未作答")]),a("el-tag",{attrs:{effect:"dark"}},[t._v("已作答")]),a("el-tag",{attrs:{type:"warning",effect:"dark"}},[t._v("当前试题")])],1),void 0!==t.paperData.radioList&&t.paperData.radioList.length>0?a("div",[a("p",{staticClass:"card-item-title"},[a("strong",{staticStyle:{"margin-left":"15px"}},[t._v("单选题")]),a("span",{staticStyle:{float:"right","margin-right":"10px","font-size":"12px"}},[t._v(" (总"+t._s(t.paperData.radioList.length)+"题/共"+t._s(t.paperData.radioList.length*t.paperData.radioList[0].score)+"分) ")])]),a("el-row",{staticClass:"card-line",attrs:{gutter:24}},t._l(t.paperData.radioList,(function(e){return a("el-tag",{key:e.id,staticStyle:{width:"35px","text-align":"center"},attrs:{type:t.cardItemType(e.answered,e.quId),effect:t.cardItemEffect(e.answered,e.quId)},on:{click:function(a){return t.handSave(e)}}},[t._v(t._s(e.sort+1))])})),1)],1):t._e(),void 0!==t.paperData.multiList&&t.paperData.multiList.length>0?a("div",[a("p",{staticClass:"card-item-title"},[a("strong",{staticStyle:{"margin-left":"15px"}},[t._v("多选题")]),a("span",{staticStyle:{float:"right","margin-right":"10px","font-size":"12px"}},[t._v(" (总"+t._s(t.paperData.multiList.length)+"题/共"+t._s(t.paperData.multiList.length*t.paperData.multiList[0].score)+"分) ")])]),a("el-row",{staticClass:"card-line",attrs:{gutter:24}},t._l(t.paperData.multiList,(function(e){return a("el-tag",{key:e.id,staticStyle:{width:"35px","text-align":"center"},attrs:{type:t.cardItemType(e.answered,e.quId),effect:t.cardItemEffect(e.answered,e.quId)},on:{click:function(a){return t.handSave(e)}}},[t._v(t._s(e.sort+1))])})),1)],1):t._e(),void 0!==t.paperData.judgeList&&t.paperData.judgeList.length>0?a("div",[a("p",{staticClass:"card-item-title"},[a("strong",{staticStyle:{"margin-left":"15px"}},[t._v("判断题")]),a("span",{staticStyle:{float:"right","margin-right":"10px","font-size":"12px"}},[t._v(" (总"+t._s(t.paperData.judgeList.length)+"题/共"+t._s(t.paperData.judgeList.length*t.paperData.judgeList[0].score)+"分) ")])]),a("el-row",{staticClass:"card-line",attrs:{gutter:24}},t._l(t.paperData.judgeList,(function(e){return a("el-tag",{key:e.id,staticStyle:{width:"35px","text-align":"center"},attrs:{type:t.cardItemType(e.answered,e.quId),effect:t.cardItemEffect(e.answered,e.quId)},on:{click:function(a){return t.handSave(e)}}},[t._v(t._s(e.sort+1))])})),1)],1):t._e(),void 0!==t.paperData.blankList&&t.paperData.blankList.length>0?a("div",[a("p",{staticClass:"card-item-title"},[a("strong",{staticStyle:{"margin-left":"15px"}},[t._v("填空题")]),a("span",{staticStyle:{float:"right","margin-right":"10px","font-size":"12px"}},[t._v(" (总"+t._s(t.paperData.blankList.length)+"题/共"+t._s(t.paperData.blankList.length*t.paperData.blankList[0].score)+"分) ")])]),a("el-row",{staticClass:"card-line",attrs:{gutter:24}},t._l(t.paperData.blankList,(function(e){return a("el-tag",{key:e.id,staticStyle:{width:"35px","text-align":"center"},attrs:{type:t.cardItemType(e.answered,e.quId),effect:t.cardItemEffect(e.answered,e.quId)},on:{click:function(a){return t.handSave(e)}}},[t._v(t._s(e.sort+1))])})),1)],1):t._e(),void 0!==t.paperData.officeQuCount&&t.paperData.officeQuCount>0?a("div",[a("p",{staticClass:"card-item-title"},[a("strong",{staticStyle:{"margin-left":"15px"}},[t._v("操作题")]),a("span",{staticStyle:{float:"right","margin-right":"10px","font-size":"12px"}},[t._v(" (总"+t._s(t.paperData.officeQuCount)+"题/共"+t._s(t.paperData.officeQuScore)+"分) ")])]),a("el-row",{staticClass:"card-line",attrs:{gutter:24}},[t._l(t.paperData.wordList,(function(e){return a("el-tag",{key:e.id,staticStyle:{width:"35px","text-align":"center"},attrs:{type:t.cardItemType(e.answered,e.quId),effect:t.cardItemEffect(e.answered,e.quId)},on:{click:function(a){return t.handSave(e)}}},[t._v(t._s(e.sort+1))])})),t._l(t.paperData.excelList,(function(e){return a("el-tag",{key:e.id,staticStyle:{width:"35px","text-align":"center"},attrs:{type:t.cardItemType(e.answered,e.quId),effect:t.cardItemEffect(e.answered,e.quId)},on:{click:function(a){return t.handSave(e)}}},[t._v(t._s(e.sort+1))])})),t._l(t.paperData.pptList,(function(e){return a("el-tag",{key:e.id,staticStyle:{width:"35px","text-align":"center"},attrs:{type:t.cardItemType(e.answered,e.quId),effect:t.cardItemEffect(e.answered,e.quId)},on:{click:function(a){return t.handSave(e)}}},[t._v(t._s(e.sort+1))])}))],2)],1):t._e()],1)],1),a("el-col",{attrs:{span:18,xs:24}},[a("el-card",{staticClass:"qu-content"},[t.quData.content?a("p",[t._v(t._s(t.quData.sort+1)+"."),a("span",{domProps:{innerHTML:t._s(t.quData.content)}})]):t._e(),null!=t.quData.image&&""!==t.quData.image?a("div",[a("el-link",{staticStyle:{"margin-bottom":"10px"},attrs:{href:t.quData.image,type:"primary",target:"_blank",icon:"el-icon-files",underline:!0}},[t._v(" 点击下载附件 ")])],1):t._e(),1===t.quData.quType||3===t.quData.quType?a("div",[a("el-radio-group",{model:{value:t.radioValue,callback:function(e){t.radioValue=e},expression:"radioValue"}},t._l(t.quData.answerList,(function(e){return a("el-radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.abc)+"."+t._s(e.content)+" "),null!=e.image&&""!==e.image?a("div",{staticStyle:{clear:"both"}},[a("el-image",{staticStyle:{"max-width":"100%"},attrs:{src:e.image}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("el-link",{attrs:{href:e.image,type:"primary",target:"_blank",icon:"el-icon-files",underline:!0}},[t._v(" 点击下载附件 ")])],1)])],1):t._e()])})),1)],1):t._e(),2===t.quData.quType?a("div",[a("el-checkbox-group",{model:{value:t.multiValue,callback:function(e){t.multiValue=e},expression:"multiValue"}},t._l(t.quData.answerList,(function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.abc)+"."+t._s(e.content)+" "),null!=e.image&&""!==e.image?a("div",{staticStyle:{clear:"both"}},[a("el-image",{staticStyle:{"max-width":"100%"},attrs:{src:e.image}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("el-link",{attrs:{href:e.image,type:"success",target:"_blank",icon:"el-icon-files",underline:!0}},[t._v(" 点击下载附件 ")])],1)])],1):t._e()])})),1)],1):t._e(),5===t.quData.quType?a("div",[a("el-input",{staticStyle:{width:"50%"},attrs:{size:"large",placeholder:"请输入答案",clearable:""},model:{value:t.answer,callback:function(e){t.answer=e},expression:"answer"}})],1):t._e(),t.quData.quType>=10?a("div",[a("file-upload",{attrs:{"list-type":"office-file",tips:"请仔细读题,根据题目要求上传.xlsx/.docx/.pptx文件",accept:".xlsx, .docx, .pptx"},model:{value:t.answer,callback:function(e){t.answer=e},expression:"answer"}})],1):t._e()]),a("div",{staticStyle:{"margin-top":"20px"}},[t.showPrevious?a("el-button",{attrs:{type:"primary",icon:"el-icon-back"},on:{click:function(e){return t.handPrevious()}}},[t._v(" 上一题 ")]):t._e(),t.showNext?a("el-button",{attrs:{type:"warning",icon:"el-icon-right"},on:{click:function(e){return t.handNext()}}},[t._v(" 下一题 ")]):t._e()],1)],1)],1)],1)},i=[],r=(a("a481"),a("55dd"),a("ac6a"),a("7f7f"),a("db72")),s=a("3200"),c=a("5c96"),o=a("2a75"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticStyle:{color:"#ff0000","font-weight":"700"}},[t._v(t._s(t.hour)+"时"+t._s(t.min)+"分钟"+t._s(t.sec)+"秒")])},u=[],p=(a("c5f6"),{name:"ExamTimer",props:{value:Number},data:function(){return{leftSeconds:0,hour:"00",min:"00",sec:"00"}},watch:{value:{handler:function(){this.leftSeconds=this.value}}},created:function(){this.leftSeconds=this.value,this.countdown()},methods:{countdown:function(){if(this.leftSeconds<0)this.$emit("timeout");else{var t=parseInt(this.leftSeconds/3600),e=parseInt(this.leftSeconds/60%60),a=parseInt(this.leftSeconds%60);this.hour=t>9?t:"0"+t,this.min=e>9?e:"0"+e,this.sec=a>9?a:"0"+a,this.leftSeconds-=1;var n=this;setTimeout((function(){n.countdown()}),1e3)}}}}),d=p,f=a("2877"),h=Object(f["a"])(d,l,u,!1,null,null,null),m=h.exports,g=a("14a5"),v=a("2f62"),w={name:"ExamProcess",components:{FileUpload:o["a"],ExamTimer:m},data:function(){return{isFullscreen:!1,showPrevious:!1,showNext:!0,loading:!1,handleText:"交卷",pageLoading:!1,fullUrl:"",timer:null,websocket:null,paperId:"",cardItem:{},allItem:[],quData:{answerList:[]},paperData:{leftSeconds:86400,radioList:[],multiList:[],judgeList:[],blankList:[],wordList:[],excelList:[],pptList:[]},radioValue:"",multiValue:[],answer:"",answeredIds:[]}},computed:Object(r["a"])({},Object(v["b"])(["sidebar","avatar","device","userId","name","realName"])),mounted:function(){this.initWebSocket(),Object(g["b"])(this.realName,this.name),window.addEventListener("beforeunload",this.beforeUnloadHandler,!1),document.addEventListener("visibilitychange",this.handleVisibilityChange,!1)},beforeDestroy:function(){this.$nextTick((function(){document.oncontextmenu=new Function,document.onselectstart=new Function}))},destroyed:function(){this.clear(),Object(g["a"])(),window.removeEventListener("beforeunload",this.beforeUnloadHandler,!1),document.removeEventListener("visibilitychange",this.handleVisibilityChange,!1)},created:function(){var t=this.$route.params.id;"undefined"!==typeof t&&null!==t&&(this.paperId=t,this.fetchData(t)),history.pushState(null,null,document.URL),window.addEventListener("popstate",(function(){history.pushState(null,null,document.URL)})),this.$nextTick((function(){document.oncontextmenu=new Function("event.returnValue=false"),document.onselectstart=new Function("event.returnValue=false")}))},methods:{handleVisibilityChange:function(t){if("visible"===t.target.visibilityState){var e=new Date(this.paperData.limitTime),a=new Date;this.paperData.leftSeconds=Math.round((e.getTime()-a.getTime())/1e3),console.log(this.paperData.leftSeconds)}},beforeUnloadHandler:function(t){t=t||window.event,t.returnValue=!0},cardItemType:function(t,e){return e===this.cardItem.quId?"warning":t?"":t?void 0:"info"},cardItemEffect:function(t,e){return e===this.cardItem.quId||t?"dark":t?void 0:""},countNotAnswered:function(){var t=0;return this.paperData.radioList.forEach((function(e){e.answered||(t+=1)})),this.paperData.multiList.forEach((function(e){e.answered||(t+=1)})),this.paperData.judgeList.forEach((function(e){e.answered||(t+=1)})),this.paperData.blankList.forEach((function(e){e.answered||(t+=1)})),this.paperData.wordList.forEach((function(e){e.answered||(t+=1)})),this.paperData.excelList.forEach((function(e){e.answered||(t+=1)})),this.paperData.pptList.forEach((function(e){e.answered||(t+=1)})),t},handNext:function(){var t=this.cardItem.sort+1;this.handSave(this.allItem[t])},handPrevious:function(){var t=this.cardItem.sort-1;this.handSave(this.allItem[t])},doHandler:function(){var t=this;this.handleText="正在交卷，请等待...",this.loading=!0;var e={id:this.paperId};Object(s["d"])(e).then((function(){t.$message({message:"试卷提交成功！",type:"success"}),t.$router.push({name:"ExamOnline"})}))},handHandExam:function(){var t=this;this.handSave(this.cardItem,(function(){var e=t.countNotAnswered(),a="确认要交卷吗？";e>0&&(a="您还有"+e+"题未作答，确认要交卷吗?"),t.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.doHandler()})).catch((function(){t.$message({type:"info",message:"交卷已取消，您可以继续作答！"})}))}))},handSave:function(t,e){var a=this;t.id===this.allItem[0].id?this.showPrevious=!1:this.showPrevious=!0;var n=this.allItem.length-1;t.id===this.allItem[n].id?this.showNext=!1:this.showNext=!0;var i=this.multiValue;""!==this.radioValue&&i.push(this.radioValue);var r={quType:this.cardItem.quType,paperId:this.paperId,quId:this.cardItem.quId,answers:i,answer:this.cardItem.quType>=10||5===this.cardItem.quType?this.answer:""};Object(s["c"])(r).then((function(){i.length>0||""!==r.answer?a.cardItem.answered=!0:a.cardItem.answered=!1,e&&e(),a.fetchQuData(t)}))},fetchQuData:function(t){var e=this,a=c["Loading"].service({text:"拼命加载中",background:"rgba(0, 0, 0, 0.7)"});this.cardItem=t;var n={paperId:this.paperId,quId:t.quId};Object(s["g"])(n).then((function(t){e.quData=t.data,e.radioValue="",e.multiValue=[],e.quData.answerList.forEach((function(t){1!==e.quData.quType&&3!==e.quData.quType||!t.checked||(e.radioValue=t.id),2===e.quData.quType&&t.checked&&e.multiValue.push(t.id)})),(e.quData.quType>=10||5===e.quData.quType)&&(e.answer=e.quData.answer),a.close()}))},fetchData:function(t){var e=this,a={id:t};Object(s["e"])(a).then((function(t){e.paperData=t.data,e.paperData.radioList?e.cardItem=e.paperData.radioList[0]:e.paperData.multiList?e.cardItem=e.paperData.multiList[0]:e.paperData.judgeList?e.cardItem=e.paperData.judgeList[0]:e.paperData.blankList?e.cardItem=e.paperData.blankList[0]:e.paperData.wordList?e.cardItem=e.paperData.wordList[0]:e.paperData.excelList?e.cardItem=e.paperData.excelList[0]:e.paperData.pptList&&(e.cardItem=e.paperData.pptList[0]);var a=e;e.paperData.radioList.forEach((function(t){a.allItem.push(t)})),e.paperData.multiList.forEach((function(t){a.allItem.push(t)})),e.paperData.judgeList.forEach((function(t){a.allItem.push(t)})),e.paperData.blankList.forEach((function(t){a.allItem.push(t)})),e.paperData.wordList.forEach((function(t){a.allItem.push(t)})),e.paperData.excelList.forEach((function(t){a.allItem.push(t)})),e.paperData.pptList.forEach((function(t){a.allItem.push(t)})),e.fetchQuData(e.cardItem),e.paperData.officeQuCount=e.paperData.wordList.length+e.paperData.excelList.length+e.paperData.pptList.length,e.paperData.officeQuScore=0,0!==e.paperData.wordList.length&&(e.paperData.officeQuScore+=e.paperData.wordList.length*e.paperData.wordList[0].score),0!==e.paperData.excelList.length&&(e.paperData.officeQuScore+=e.paperData.excelList.length*e.paperData.excelList[0].score),0!==e.paperData.pptList.length&&(e.paperData.officeQuScore+=e.paperData.pptList.length*e.paperData.pptList[0].score)}))},initWebSocket:function(){var t="".concat(""),e="/api/socket/paper/"+this.paperId;""===t?this.fullUrl="".concat("https:"===location.protocol?"wss":"ws","://").concat(location.host).concat(e):(this.fullUrl=t.replace("https://","wss://").replace("http://","ws://"),this.fullUrl="".concat(this.fullUrl).concat(e)),console.log(this.fullUrl),this.clear(),this.connect()},connect:function(){console.log("++++connect",this.fullUrl),this.websocket=new WebSocket(this.fullUrl),this.websocket.onopen=this.onOpen,this.websocket.onerror=this.onError,this.websocket.onclose=this.onClose,this.websocket.onmessage=this.onMessage},onOpen:function(){this.beat()},onError:function(t){console.log("socket error",t)},onClose:function(t){console.log("socket error",t)},onMessage:function(t){var e=t.data;"pong"!==e&&this.$notify({title:"通知",message:e,type:"warning",duration:0})},clear:function(){null!=this.websocket&&1===this.websocket.readyState&&this.websocket.close(),null!=this.timer&&clearInterval(this.timer)},beat:function(){var t=this;null!=this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){t.ping()}),1e4),this.ping()},ping:function(){1===this.websocket.readyState?this.websocket.send("ping"):this.connect()}}},y=w,D=(a("f819"),Object(f["a"])(y,n,i,!1,null,"0bd692da",null));e["default"]=D.exports},7985:function(t,e,a){},f819:function(t,e,a){"use strict";a("7985")}}]);