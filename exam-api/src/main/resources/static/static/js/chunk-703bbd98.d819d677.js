(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-703bbd98"],{1:function(e,t){},2017:function(e,t,i){"use strict";i("cafe")},"8bc5":function(e,t,i){"use strict";i("eed6")},"9ed6":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticClass:"login-container"},[i("el-main",[i("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules,autocomplete:"on","label-position":"left"}},[i("div",{staticClass:"login-main"},[i("div",{staticClass:"title-container"},[i("h3",{staticClass:"title"},[e._v(e._s(e.siteData.siteName))])]),i("el-form-item",{attrs:{prop:"username"}},[i("span",{staticClass:"svg-container"},[i("svg-icon",{attrs:{"icon-class":"user"}})],1),i("el-input",{ref:"username",attrs:{placeholder:"用户名",name:"username",type:"text",tabindex:"1",autocomplete:"on"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),i("el-tooltip",{attrs:{content:"Caps lock is On",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[i("el-form-item",{attrs:{prop:"password"}},[i("span",{staticClass:"svg-container"},[i("svg-icon",{attrs:{"icon-class":"password"}})],1),i("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"密码",name:"password",tabindex:"2",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1}},nativeOn:{keyup:[function(t){return e.checkCapslock(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.showVerify(t)}]},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),i("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[i("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1)],1),i("div",{staticStyle:{position:"relative"}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},on:{click:e.showVerify}},[e._v("登录")])],1)],1)],1)],1)])],1),i("verify",{ref:"verify",attrs:{mode:"pop","img-size":{width:"330px",height:"155px"}},on:{success:e.handleLogin}})],1)},o=[],n=(i("ac6a"),i("456d"),i("db72")),r=i("2f62"),a=i("61f7"),c=(i("e05f"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.showBox,expression:"showBox"}],class:"pop"===e.mode?"mask":""},[i("div",{class:"pop"===e.mode?"verifybox":"",style:{"max-width":parseInt(e.imgSize.width)+30+"px"}},["pop"===e.mode?i("div",{staticClass:"verifybox-top"},[e._v(" 请完成安全验证 "),i("span",{staticClass:"verifybox-close",on:{click:e.closeBox}},[i("i",{staticClass:"iconfont icon-close"})])]):e._e(),i("div",{staticClass:"verifybox-bottom",style:{padding:"pop"===e.mode?"15px":"0"}},[i("verify-slide",{ref:"instance",attrs:{"captcha-type":e.captchaType,type:e.verifyType,figure:e.figure,arith:e.arith,mode:e.mode,"v-space":e.vSpace,explain:e.explain,"img-size":e.imgSize,"block-size":e.blockSize,"bar-size":e.barSize,"default-img":e.defaultImg}})],1)])])}),l=[],h=(i("6b54"),i("c5f6"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{position:"relative"}},["2"===e.type?i("div",{staticClass:"verify-img-out",style:{height:parseInt(e.setSize.imgHeight)+e.vSpace+"px"}},[i("div",{staticClass:"verify-img-panel",style:{width:e.setSize.imgWidth,height:e.setSize.imgHeight}},[i("img",{staticStyle:{width:"100%",height:"100%",display:"block"},attrs:{src:e.backImgBase?"data:image/png;base64,"+e.backImgBase:e.defaultImg,alt:""}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showRefresh,expression:"showRefresh"}],staticClass:"verify-refresh",on:{click:e.refresh}},[i("i",{staticClass:"iconfont icon-refresh"})]),i("transition",{attrs:{name:"tips"}},[e.tipWords?i("span",{staticClass:"verify-tips",class:e.passFlag?"suc-bg":"err-bg"},[e._v(e._s(e.tipWords))]):e._e()])],1)]):e._e(),i("div",{staticClass:"verify-bar-area",style:{width:e.setSize.imgWidth,height:e.barSize.height,"line-height":e.barSize.height}},[i("span",{staticClass:"verify-msg",domProps:{textContent:e._s(e.text)}}),i("div",{staticClass:"verify-left-bar",style:{width:void 0!==e.leftBarWidth?e.leftBarWidth:e.barSize.width,height:e.barSize.height,"border-color":e.leftBarBorderColor,transaction:e.transitionWidth}},[i("span",{staticClass:"verify-msg",domProps:{textContent:e._s(e.finishText)}}),i("div",{staticClass:"verify-move-block",style:{width:e.barSize.width,height:e.barSize.height,"background-color":e.moveBlockBackgroundColor,left:e.moveBlockLeft,transition:e.transitionLeft},on:{touchstart:e.start,mousedown:e.start}},[i("i",{class:["verify-icon iconfont",e.iconClass],style:{color:e.iconColor}}),"2"===e.type?i("div",{staticClass:"verify-sub-block",style:{width:Math.floor(47*parseInt(e.setSize.imgWidth)/310)+"px",height:e.setSize.imgHeight,top:"-"+(parseInt(e.setSize.imgHeight)+e.vSpace)+"px","background-size":e.setSize.imgWidth+" "+e.setSize.imgHeight}},[i("img",{staticStyle:{width:"100%",height:"100%",display:"block"},attrs:{src:"data:image/png;base64,"+e.blockBackImgBase,alt:""}})]):e._e()])])])])}),d=[],p=(i("a481"),i("3452")),u=i.n(p);function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"XwKsGlMcdPMEhR1B",i=u.a.enc.Utf8.parse(t),s=u.a.enc.Utf8.parse(e),o=u.a.AES.encrypt(s,i,{mode:u.a.mode.ECB,padding:u.a.pad.Pkcs7});return o.toString()}function g(e){var t,i,s,o,n=e.$el.parentNode.offsetWidth||window.offsetWidth,r=e.$el.parentNode.offsetHeight||window.offsetHeight;return t=-1!==e.imgSize.width.indexOf("%")?parseInt(this.imgSize.width)/100*n+"px":this.imgSize.width,i=-1!==e.imgSize.height.indexOf("%")?parseInt(this.imgSize.height)/100*r+"px":this.imgSize.height,s=-1!==e.barSize.width.indexOf("%")?parseInt(this.barSize.width)/100*n+"px":this.barSize.width,o=-1!==e.barSize.height.indexOf("%")?parseInt(this.barSize.height)/100*r+"px":this.barSize.height,{imgWidth:t,imgHeight:i,barWidth:s,barHeight:o}}var m=i("bc3a"),v=i.n(m);v.a.defaults.baseURL="";var y=v.a.create({timeout:4e4,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json; charset=UTF-8"}});y.interceptors.request.use((function(e){return e}),(function(e){Promise.reject(e)})),y.interceptors.response.use((function(e){return e.data}),(function(e){}));var w=y;function b(e){return w({url:"/captcha/get",method:"post",data:e})}function k(e){return w({url:"/captcha/check",method:"post",data:e})}var S={name:"VerifySlide",props:{captchaType:{type:String,default:"blockPuzzle"},type:{type:String,default:"1"},mode:{type:String,default:"fixed"},vSpace:{type:Number,default:5},explain:{type:String,default:"向右滑动完成验证"},imgSize:{type:Object,default:function(){return{width:"310px",height:"155px"}}},blockSize:{type:Object,default:function(){return{width:"50px",height:"50px"}}},barSize:{type:Object,default:function(){return{width:"40px",height:"40px"}}},defaultImg:{type:String,default:""}},data:function(){return{secretKey:"",passFlag:"",backImgBase:"",blockBackImgBase:"",backToken:"",startMoveTime:"",endMovetime:"",tipsBackColor:"",tipWords:"",text:"",finishText:"",setSize:{imgHeight:0,imgWidth:0,barHeight:0,barWidth:0},top:0,left:0,moveBlockLeft:void 0,leftBarWidth:void 0,moveBlockBackgroundColor:void 0,leftBarBorderColor:"#ddd",iconColor:void 0,iconClass:"icon-right",status:!1,isEnd:!1,showRefresh:!0,transitionLeft:"",transitionWidth:""}},computed:{barArea:function(){return this.$el.querySelector(".verify-bar-area")},resetSize:function(){return g}},watch:{type:{immediate:!0,handler:function(){this.init()}}},mounted:function(){this.$el.onselectstart=function(){return!1},console.log(this.defaultImg)},methods:{init:function(){var e=this;this.text=this.explain,this.getPictrue(),this.$nextTick((function(){var t=e.resetSize(e);for(var i in t)e.$set(e.setSize,i,t[i]);e.$parent.$emit("ready",e)}));var t=this;window.removeEventListener("touchmove",(function(e){t.move(e)})),window.removeEventListener("mousemove",(function(e){t.move(e)})),window.removeEventListener("touchend",(function(){t.end()})),window.removeEventListener("mouseup",(function(){t.end()})),window.addEventListener("touchmove",(function(e){t.move(e)})),window.addEventListener("mousemove",(function(e){t.move(e)})),window.addEventListener("touchend",(function(){t.end()})),window.addEventListener("mouseup",(function(){t.end()}))},start:function(e){var t;e=e||window.event,t=e.touches?e.touches[0].pageX:e.clientX,this.startLeft=Math.floor(t-this.barArea.getBoundingClientRect().left),this.startMoveTime=+new Date,!1===this.isEnd&&(this.text="",this.moveBlockBackgroundColor="#337ab7",this.leftBarBorderColor="#337AB7",this.iconColor="#fff",e.stopPropagation(),this.status=!0)},move:function(e){if(e=e||window.event,this.status&&!1===this.isEnd){var t;t=e.touches?e.touches[0].pageX:e.clientX;var i=this.barArea.getBoundingClientRect().left,s=t-i;s>=this.barArea.offsetWidth-parseInt(parseInt(this.blockSize.width)/2)-2&&(s=this.barArea.offsetWidth-parseInt(parseInt(this.blockSize.width)/2)-2),s<=0&&(s=parseInt(parseInt(this.blockSize.width)/2)),this.moveBlockLeft=s-this.startLeft+"px",this.leftBarWidth=s-this.startLeft+"px"}},end:function(){var e=this;this.endMovetime=+new Date;var t=this;if(this.status&&!1===this.isEnd){var i=parseInt((this.moveBlockLeft||"").replace("px",""));i=310*i/parseInt(this.setSize.imgWidth);var s={captchaType:this.captchaType,pointJson:this.secretKey?f(JSON.stringify({x:i,y:5}),this.secretKey):JSON.stringify({x:i,y:5}),token:this.backToken};k(s).then((function(s){if("0000"===s.repCode){e.moveBlockBackgroundColor="#5cb85c",e.leftBarBorderColor="#5cb85c",e.iconColor="#fff",e.iconClass="icon-check",e.showRefresh=!1,e.isEnd=!0,"pop"===e.mode&&setTimeout((function(){e.$parent.clickShow=!1,e.refresh()}),1500),e.passFlag=!0,e.tipWords="".concat(((e.endMovetime-e.startMoveTime)/1e3).toFixed(2),"s验证成功");var o=e.secretKey?f(e.backToken+"---"+JSON.stringify({x:i,y:5}),e.secretKey):e.backToken+"---"+JSON.stringify({x:i,y:5});setTimeout((function(){e.tipWords="",e.$parent.closeBox(),e.$parent.$emit("success",{captchaVerification:o})}),1e3)}else e.moveBlockBackgroundColor="#d9534f",e.leftBarBorderColor="#d9534f",e.iconColor="#fff",e.iconClass="icon-close",e.passFlag=!1,setTimeout((function(){t.refresh()}),1e3),e.$parent.$emit("error",e),e.tipWords="验证失败",setTimeout((function(){e.tipWords=""}),1e3)})),this.status=!1}},refresh:function(){var e=this;this.showRefresh=!0,this.finishText="",this.transitionLeft="left .3s",this.moveBlockLeft=0,this.leftBarWidth=void 0,this.transitionWidth="width .3s",this.leftBarBorderColor="#ddd",this.moveBlockBackgroundColor="#fff",this.iconColor="#000",this.iconClass="icon-right",this.isEnd=!1,this.getPictrue(),setTimeout((function(){e.transitionWidth="",e.transitionLeft="",e.text=e.explain}),300)},getPictrue:function(){var e=this,t={captchaType:this.captchaType,clientUid:localStorage.getItem("slider"),ts:Date.now()};b(t).then((function(t){"0000"===t.repCode?(e.backImgBase=t.repData.originalImageBase64,e.blockBackImgBase=t.repData.jigsawImageBase64,e.backToken=t.repData.token,e.secretKey=t.repData.secretKey):e.tipWords=t.repMsg,"6201"===t.repCode&&(e.backImgBase=null,e.blockBackImgBase=null)}))}}},x=S,B=i("2877"),C=Object(B["a"])(x,h,d,!1,null,null,null),z=C.exports,T={name:"Vue2Verify",components:{VerifySlide:z},props:{locale:{require:!1,type:String,default:function(){var e;return e=navigator.language?navigator.language:navigator.browserLanguage,e}},captchaType:{type:String,default:"blockPuzzle"},figure:{type:Number},arith:{type:Number},mode:{type:String,default:"pop"},vSpace:{type:Number},explain:{type:String},imgSize:{type:Object,default:function(){return{width:"310px",height:"155px"}}},blockSize:{type:Object},barSize:{type:Object}},data:function(){return{clickShow:!1,verifyType:void 0,defaultImg:i("a36b")}},computed:{instance:function(){return this.$refs.instance||{}},showBox:function(){return"pop"!==this.mode||this.clickShow}},watch:{captchaType:{immediate:!0,handler:function(e){switch(e.toString()){case"blockPuzzle":this.verifyType="2",this.componentType="VerifySlide";break;case"clickWord":this.verifyType="",this.componentType="VerifyPoints";break}}}},mounted:function(){this.uuid()},methods:{uuid:function(){for(var e=[],t="0123456789abcdef",i=0;i<36;i++)e[i]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var s="slider-"+e.join(""),o="point-"+e.join("");console.log(localStorage.getItem("slider")),localStorage.getItem("slider")||localStorage.setItem("slider",s),localStorage.getItem("point")||localStorage.setItem("point",o)},i18n:function(e){if(this.$t)return this.$t(e);var t=this.$options.i18n.messages[this.locale]||this.$options.i18n.messages["en-US"];return t[e]},refresh:function(){this.instance.refresh&&this.instance.refresh()},closeBox:function(){this.clickShow=!1,this.refresh()},show:function(){"pop"==this.mode&&(this.clickShow=!0)}}},I=T,$=(i("8bc5"),Object(B["a"])(I,c,l,!1,null,null,null)),W=$.exports,L={name:"Login",components:{verify:W},data:function(){var e=function(e,t,i){Object(a["d"])(t)?i():i(new Error("请输入正确的用户名！"))},t=function(e,t,i){t.length<5?i(new Error("密码不能小于5个字符")):i()};return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,trigger:"blur",validator:e}],password:[{required:!0,trigger:"blur",validator:t}]},passwordType:"password",capsTooltip:!1,loading:!1,redirect:void 0,otherQuery:{}}},computed:Object(n["a"])({},Object(r["b"])(["siteData"])),watch:{$route:{handler:function(e){var t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}},created:function(){},mounted:function(){""===this.loginForm.username?this.$refs.username.focus():""===this.loginForm.password&&this.$refs.password.focus()},destroyed:function(){},methods:{studentRegister:function(){this.$router.push({name:"Register"})},checkCapslock:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shiftKey,i=e.key;i&&1===i.length&&(this.capsTooltip=!!(t&&i>="a"&&i<="z"||!t&&i>="A"&&i<="Z")),"CapsLock"===i&&!0===this.capsTooltip&&(this.capsTooltip=!1)},showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(e){var t=this;this.$refs.loginForm.validate((function(i){if(!i)return console.log("提交错误！"),!1;t.loading=!0,t.loginForm.captchaVerification=e.captchaVerification,t.$store.dispatch("user/login",t.loginForm).then((function(){t.$router.push({path:t.redirect||"/",query:t.otherQuery}),t.loading=!1})).catch((function(){t.loading=!1}))}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(t,i){return"redirect"!==i&&(t[i]=e[i]),t}),{})},showVerify:function(){this.$refs.verify.show()}}},O=L,E=(i("2017"),i("d0b4"),Object(B["a"])(O,s,o,!1,null,"001ab899",null));t["default"]=E.exports},a36b:function(e,t,i){e.exports=i.p+"static/img/404.a57b6f31.png"},cafe:function(e,t,i){},d0b4:function(e,t,i){"use strict";i("e48d")},e48d:function(e,t,i){},eed6:function(e,t,i){}}]);